function msResizeImg(){var t=$(this);t.ready(function(){t.removeClass("aw").removeClass("ah");var e=t.get(0).naturalWidth,a=t.get(0).naturalHeight;0===e||0===a||(a<e?t.addClass("aw"):t.addClass("ah"))})}$(function(){if("function"==typeof swiperSlider&&$(".card-container").is("div")){var t=function(){$(".modal-body .card-right").html($(".user-details").html())},i=function(e,a){$(e+" .ms-slider-cur-ct").text(a)},n={container:".swiper-container",options:{loop:!1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},on:{slideChangeTransitionEnd:function(){i(this.params.el,this.realIndex+1)}}}},o=swiperSlider(n),s=$("#ms-slider");$(document).on("click",".ms-slider-resizer > a",function(e){if("_blank"!=$(".ms-slider-resizer > a",$(e.target).parents(".swiper-container")).attr("target")){e.preventDefault();var a=$(".swiper-container").clone().addClass("modal-container");a.find(".swiper-button-disabled").removeClass("swiper-button-disabled"),s.find(".ms-slider-wrapper-container").html(a.get(0).outerHTML),s.find(".ms-slider-resizer").find("a").attr("href",!0).find("i").removeClass("fa-arrows-alt").addClass("fa-expand"),n.container=".modal-container",n.options.initialSlide=o.realIndex,1<o.slides.length&&(n.options.loop=!0),s.modal("show").on("shown.bs.modal",function(){t(),n.options=Object.assign(n.options,{on:{slideChange:function(){var e=this.slides[this.activeIndex],a=$(e).find("img"),t=$(a).attr("src")||$(a).attr("data-src");s.find(".ms-slider-resizer > a").attr("href",t).attr("target","_blank"),i(this.params.el,this.realIndex+1)}}}),swiperSlider(n)})}})}});var googleLayer=function(e){dataLayer.push({event:"obyavlenie",city_ad:e.data("city_ga"),region_ad:e.data("region_ga"),url_ad:e.data("category_ga"),status_ad:e.data("status_ga")})},$_mes_breadcrumbs=$("#message-breadcrumbs"),input_count_value=$("input.count-value"),showLoginForm=function(e,a){if(is_guest){if(void 0!==a){var t=calculateBuyNowHref();$('input[name="LoginForm[redirect]"]').val(t),$('input[name="SignupForm[redirect]"]').val(t)}return tryOpenModal("#enter-site",e),!0}return!1},calculateBuyNowHref=function(){var e=parseInt(input_count_value.val()||1),a=1,t=parseInt(input_count_value.attr("max"));return t<e&&(e=t),e<a&&(e=a),!!e&&location.href+"?count_product="+e},checkTopContainer=function(){var e=window.pageYOffset||document.documentElement.scrollTop,a=$(".card-container-top"),t=$(".card-container-bottom"),i=($(window).width(),$(window).height());500<e&&320<i?(a.hasClass("active")||a.addClass("active"),t.hasClass("active")||t.addClass("active")):(a.hasClass("active")&&a.removeClass("active"),t.hasClass("active")&&t.removeClass("active"))},clearComplainFile=function(e){var a=$("#complain_form");$("span#label-fb").html(lang.t("Прикрепить файл")),a.find(".fileupload input").val(""),yii.alert(e)},mobileCardBlockVue={};$(document).on("click",".show-all-description",function(){var e=$(this),a=$(".card-wrap-description"),t=$(".card-description");e.hide(),$(".hide-all-description").show(),a.css("max-height",t.height()+"px")}).on("click",".hide-all-description",function(){var e=$(this),a=$(".card-wrap-description");$(".card-description");e.hide(),$(".show-all-description").show(),a.css("max-height","")}).on("click",".btn-minus",function(){var e=parseInt(input_count_value.val());1<e&&(e--,input_count_value.val(e))}).on("click",".btn-plus",function(){var e=parseInt(input_count_value.val());e<parseInt(input_count_value.attr("max"))&&(e++,input_count_value.val(e))}).on("blur",".count-value",function(){var e=parseInt(input_count_value.val()||1),a=1,t=parseInt(input_count_value.attr("max"));isNaN(e)?e=a:t<e?e=t:e<a&&(e=a),input_count_value.val(e)}).on("click",".btn-buy-now",function(e){if(showLoginForm(e,!0))return e.preventDefault(),!1;var a=calculateBuyNowHref();!1!==a&&(e.preventDefault(),location.href=a)}).on("hide.bs.modal","#complain",function(){$("#complain").remove()}).on("beforeSubmit","#complain_form",function(e){e.preventDefault();var t=$("#complain_form"),a=new FormData(this);return $.ajax({type:"post",data:a,url:"/complain/save",processData:!1,contentType:!1,success:function(e){void 0!==e.error&&$.each(e.error,function(e,a){t.yiiActiveForm("updateAttribute",e,[""]),t.yiiActiveForm("updateAttribute",e,a)}),!0===e&&($(document).one("hide.bs.modal","#complain",function(){tryOpenModal("complaint-sent-success")}),$("#complain").modal("hide"))}}),!1}).on("change","#complain_form input[type=file]",function(e){var a="";a=$(e.target).val().replace(/.+[\\\/]/,""),$("span#label-fb").html(a),$(this)[0].files[0].type.match(/(?:jpe?g|gif|png|txt|doc|docx|zip|rar|xls|xlsx|tar|xlt|pdf)s*/gi)?5242880<$(this)[0].files[0].size?clearComplainFile(lang.t("Размер файла превышает 5мб")):$(this).closest(".fileupload").find("#user_file_complain").val($(this)[0].files[0].name):clearComplainFile(lang.t("Неверный формат файла"))}).one("show.bs.modal","#show-phone",function(){var e=$("#ext-user-info");e.length&&($("#ext-user-info-modal").html(e.html()),$("#ext-user-name-modal").text($(".user-name .hne").text()))}).on("click",'input[name="groupOfPhoneRadios"]',function(){$(".li-phone").hide();var e=$('input[name="groupOfPhoneRadios"]:checked').val();$("#li"+e).show()}),window.addEventListener("scroll",checkTopContainer),$(function(){var e=$(".card-wrap-description"),a=$(".card-description");10<a.height()-e.height()&&$(".show-all-description").show(),166===Number(window.root_category_id)&&($(".hide-all-description").hide(),$(".show-all-description").hide(),e.css("max-height",a.height()+"px")),document.getElementById("mobile-card-block")&&window.containerSearcherVue&&(mobileCardBlockVue=new Vue({el:"#mobile-card-block",data:{selectedCategory:{name:""},modalCategoryOpened:!1,deviceType:null,hoverCategoryId:0},methods:{openModal:function(e){$(document).trigger("vue:open-category-modal",{id:window.root_category_id})},goCategory:function(e){this.selectedCategory.url&&(window.location.href=this.selectedCategory.url)},changeDeviceType:function(e){this.deviceType=e}},created:function(){this.selectedCategory=containerSearcherVue.selectedCategory,this.root_category_id=root_category_id,this.deviceType=getDeviceType()}})),googleLayer($_mes_breadcrumbs),checkTopContainer()});var getAddedMessages=function(e){$.ajax({type:"post",data:e,url:"/message/added-messages",success:function(e){e&&containerAddedMessagesVue.addMessages(e)},error:function(e,a,t){console.log("error added messages",a,e,t)},cache:!1})};$(document).on("click",".btn-added-messages",function(e){e.preventDefault();var t=[],a=$(this).closest("div").find(".feed.messages");$.each(a.find(".msg-one"),function(e,a){t.push($(a).find(".add_favorite").data("id"))}),t.push($(".card-actions .add_favorite").data("id")),getAddedMessages({message:{category_id:category_id,region_id:region_id,city_id:city_id,ids:t}})});var containerAddedMessagesVue=new Vue({el:"#added-messages",data:{messages:[],tali:!0,is_avatar:!1},created:function(){getAddedMessages({message:{category_id:category_id,region_id:region_id,city_id:city_id,ids:[message_id]}})},methods:{addMessages:function(e){var a=this.messages;this.messages.forEach(function(e){e.src=e.has_images?e.main_image:null}),e.forEach(function(e){e.title=(""+e.title).replace('"','"'),a.push(e)}),this.messages=a,lazyLoadInstance&&setTimeout(function(){lazyLoadInstance.update()},200),e.length<6&&$(".btn-added-messages").hide()}}});lazyLoadInstance&&setTimeout(function(){lazyLoadInstance.update()},200);